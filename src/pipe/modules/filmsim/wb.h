#pragma once
// the rest of this header is autogenerated by the following script:
#if 0
#!/bin/bash

films=(
kodak_ektar_100
kodak_portra_160
kodak_portra_400
kodak_portra_800
kodak_portra_800_push1
kodak_portra_800_push2
kodak_gold_200
kodak_ultramax_400
kodak_vision3_50d
kodak_vision3_250d
kodak_vision3_200t
kodak_vision3_500t
fujifilm_pro_400h
fujifilm_xtra_400
fujifilm_c200
)

papers=(
kodak_endura_premier,
kodak_ektacolor_edge,
kodak_supra_endura,
kodak_portra_endura,
fujifilm_crystal_archive_typeii,
kodak_2383,
kodak_2393
)

n_films=${#films[@]}
n_papers=${#papers[@]}
# ${films[0]}

cat << EOF > neutral.cfg
frames:1
fps:0
module:const:main:23.3783:290.7
module:filmsim:01:255.558:326.7
module:display:main:719.252:340.033
module:pick:01:510.405:124.7
module:i-lut:filmsim:21.3333:441
module:i-lut:spectem:20:580.333
connect:const:main:output:filmsim:01:input
connect:i-lut:filmsim:output:filmsim:01:filmsim
connect:i-lut:spectem:output:filmsim:01:spectra
connect:filmsim:01:output:display:main:input
connect:filmsim:01:output:pick:01:input
param:const:main:nspots:1
param:const:main:mode:0
param:const:main:wd:4
param:const:main:ht:4
param:pick:01:nspots:1
param:pick:01:spots:0:1:0:1
param:pick:01:show:2
param:pick:01:grab:1
param:pick:01:freeze:0
param:i-lut:filmsim:filename:data/filmsim.lut
param:i-lut:spectem:filename:data/spectra-em.lut
param:const:main:colour:0.184:0.184:0.184:1
param:pick:01:ref:0.184:0.184:0.184
param:filmsim:01:filter c:0.2
param:filmsim:01:filter m:0.5
param:filmsim:01:filter y:0.5
param:filmsim:01:ev paper:0
param:filmsim:01:couplers:0
param:filmsim:01:halation:0
param:filmsim:01:grain:0
EOF

# this is for 0.5 linear, i.e. more highlights
# param:const:main:colour:0.5:0.5:0.5:1
# param:pick:01:ref:.4821:0.5:.41255
# this is the 50% after gamma:
# param:const:main:colour:0.184:0.184:0.184:1
# D50
# param:pick:01:ref:0.1774128:0.184:0.1518184
# D65
# param:pick:01:ref:0.184:0.184:0.184

echo "// ev paper, filter c, filter m, filter y" > results.txt
echo "const float wb[$n_films][$n_papers][4] = {" >> results.txt
f=0
for film in ${films[@]}
do
  p=0
  echo "{" >> results.txt
  for paper in ${papers[@]}
  do
    echo $film $paper $f $p

#--nelder-mead
#--adam 0.00001 0.99 0.999 1e-3
    vkdt fit -d none -g neutral.cfg \
      --param "filmsim:01:filter c" \
      --param "filmsim:01:filter m" \
      --param "filmsim:01:filter y" \
      --param "filmsim:01:ev paper" \
      --target "pick:01:de76" \
      --bogosearch \
      --config "param:filmsim:01:film:$f" "param:filmsim:01:paper:$p" > neutral-warmup.cfg
    vkdt fit -d none -g neutral-warmup.cfg \
      --param "filmsim:01:filter c" \
      --param "filmsim:01:filter m" \
      --param "filmsim:01:filter y" \
      --param "filmsim:01:ev paper" \
      --target "pick:01:de76" \
      --nelder-mead \
      --config "param:filmsim:01:film:$f" "param:filmsim:01:paper:$p" > neutral-opt.cfg
    echo "{ //" $film $paper $f $p >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:ev paper' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter c' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter m' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter y' | cut -d: -f5), >> results.txt
    echo "}," >> results.txt
    p=$((p+1))
  done
  echo "}," >> results.txt
  f=$((f+1))
done
echo "};" >> results.txt
rm neutral-opt.cfg
#endif

// ev paper, filter c, filter m, filter y
const float wb[15][7][4] = {
{
{ // kodak_ektar_100 kodak_endura_premier, 0 0
-0.78839,
0.0151048,
0.678984,
0.574533,
},
{ // kodak_ektar_100 kodak_ektacolor_edge, 0 1
0.928049,
0.42914,
0.876769,
0.881453,
},
{ // kodak_ektar_100 kodak_supra_endura, 0 2
-0.18147,
0.302597,
0.565171,
0.617118,
},
{ // kodak_ektar_100 kodak_portra_endura, 0 3
-0.175688,
0.302278,
0.591403,
0.587458,
},
{ // kodak_ektar_100 fujifilm_crystal_archive_typeii, 0 4
-0.789647,
0.105355,
0.77185,
0.864062,
},
{ // kodak_ektar_100 kodak_2383, 0 5
4.62109,
0.196493,
0.831696,
0.956056,
},
{ // kodak_ektar_100 kodak_2393 0 6
3.42677,
0.356625,
0.640906,
0.768679,
},
},
{
{ // kodak_portra_160 kodak_endura_premier, 1 0
-1.33863,
0.259669,
0.548234,
0.593054,
},
{ // kodak_portra_160 kodak_ektacolor_edge, 1 1
-0.5824,
0.200769,
0.68726,
0.790451,
},
{ // kodak_portra_160 kodak_supra_endura, 1 2
-0.165082,
0.611593,
0.49778,
0.786212,
},
{ // kodak_portra_160 kodak_portra_endura, 1 3
-1.0565,
0.329068,
0.288344,
0.589968,
},
{ // kodak_portra_160 fujifilm_crystal_archive_typeii, 1 4
-1.44969,
0.264194,
0.659759,
0.853285,
},
{ // kodak_portra_160 kodak_2383, 1 5
3.69564,
0.25014,
0.70486,
0.949531,
},
{ // kodak_portra_160 kodak_2393 1 6
1.71661,
0.148984,
0.00396362,
0.584599,
},
},
{
{ // kodak_portra_400 kodak_endura_premier, 2 0
1.25102,
0.718577,
0.771743,
0.78664,
},
{ // kodak_portra_400 kodak_ektacolor_edge, 2 1
0.532589,
0.295399,
0.606487,
0.715173,
},
{ // kodak_portra_400 kodak_supra_endura, 2 2
0.282315,
0.410722,
0.13638,
0.608122,
},
{ // kodak_portra_400 kodak_portra_endura, 2 3
0.404811,
0.446317,
0.222337,
0.606961,
},
{ // kodak_portra_400 fujifilm_crystal_archive_typeii, 2 4
-1.0016,
0.0033096,
0.364934,
0.725899,
},
{ // kodak_portra_400 kodak_2383, 2 5
4.68531,
0.215715,
0.620304,
0.922875,
},
{ // kodak_portra_400 kodak_2393 2 6
3.1834,
0.302907,
0.0357231,
0.52628,
},
},
{
{ // kodak_portra_800 kodak_endura_premier, 3 0
0.0846527,
0.0956407,
0.46641,
0.590705,
},
{ // kodak_portra_800 kodak_ektacolor_edge, 3 1
1.78194,
0.458882,
0.789699,
0.882532,
},
{ // kodak_portra_800 kodak_supra_endura, 3 2
0.261813,
0.106814,
0.30001,
0.474575,
},
{ // kodak_portra_800 kodak_portra_endura, 3 3
2.30141,
0.739721,
0.729709,
0.848731,
},
{ // kodak_portra_800 fujifilm_crystal_archive_typeii, 3 4
0.654972,
0.406152,
0.734396,
0.907955,
},
{ // kodak_portra_800 kodak_2383, 3 5
5,
0,
0.661288,
0.942885,
},
{ // kodak_portra_800 kodak_2393 3 6
4.03154,
0.359937,
0.327695,
0.732934,
},
},
{
{ // kodak_portra_800_push1 kodak_endura_premier, 4 0
0.97306,
0.0828843,
0.503924,
0.646735,
},
{ // kodak_portra_800_push1 kodak_ektacolor_edge, 4 1
1.77522,
0.0683866,
0.661013,
0.820992,
},
{ // kodak_portra_800_push1 kodak_supra_endura, 4 2
1.33948,
0.198149,
0.369657,
0.607577,
},
{ // kodak_portra_800_push1 kodak_portra_endura, 4 3
1.94742,
0.432087,
0.536254,
0.712338,
},
{ // kodak_portra_800_push1 fujifilm_crystal_archive_typeii, 4 4
0.894339,
0.0817447,
0.637952,
0.88389,
},
{ // kodak_portra_800_push1 kodak_2383, 4 5
4.99944,
0.000138748,
0.60918,
0.941374,
},
{ // kodak_portra_800_push1 kodak_2393 4 6
4.21988,
0,
0.113147,
0.643338,
},
},
{
{ // kodak_portra_800_push2 kodak_endura_premier, 5 0
1.20728,
0.057532,
0.41964,
0.631005,
},
{ // kodak_portra_800_push2 kodak_ektacolor_edge, 5 1
2.96059,
0.452921,
0.777686,
0.897343,
},
{ // kodak_portra_800_push2 kodak_supra_endura, 5 2
2.04463,
0.370776,
0.411678,
0.699574,
},
{ // kodak_portra_800_push2 kodak_portra_endura, 5 3
3.68909,
0.761337,
0.751761,
0.889279,
},
{ // kodak_portra_800_push2 fujifilm_crystal_archive_typeii, 5 4
1.08265,
0.00835069,
0.564818,
0.876737,
},
{ // kodak_portra_800_push2 kodak_2383, 5 5
4.99992,
0.000265253,
0.496819,
0.933458,
},
{ // kodak_portra_800_push2 kodak_2393 5 6
4.82939,
0.157641,
0.166058,
0.703007,
},
},
{
{ // kodak_gold_200 kodak_endura_premier, 6 0
-0.218321,
0.590305,
0.630202,
0.709122,
},
{ // kodak_gold_200 kodak_ektacolor_edge, 6 1
0.654807,
0.619962,
0.763453,
0.859975,
},
{ // kodak_gold_200 kodak_supra_endura, 6 2
-0.559316,
0.376766,
0.290662,
0.5504,
},
{ // kodak_gold_200 kodak_portra_endura, 6 3
-0.709761,
0.312272,
0.298847,
0.46348,
},
{ // kodak_gold_200 fujifilm_crystal_archive_typeii, 6 4
-0.482709,
0.591739,
0.693091,
0.88972,
},
{ // kodak_gold_200 kodak_2383, 6 5
3.50313,
0.066159,
0.470268,
0.911225,
},
{ // kodak_gold_200 kodak_2393 6 6
2.56439,
0.411233,
0.0435635,
0.61178,
},
},
{
{ // kodak_ultramax_400 kodak_endura_premier, 7 0
-0.111502,
0.323251,
0.514284,
0.520197,
},
{ // kodak_ultramax_400 kodak_ektacolor_edge, 7 1
0.125193,
0.0697585,
0.533193,
0.653351,
},
{ // kodak_ultramax_400 kodak_supra_endura, 7 2
-0.305884,
0.071782,
0.294201,
0.247606,
},
{ // kodak_ultramax_400 kodak_portra_endura, 7 3
0.374998,
0.379536,
0.470185,
0.472312,
},
{ // kodak_ultramax_400 fujifilm_crystal_archive_typeii, 7 4
-0.810338,
0.083189,
0.466935,
0.778129,
},
{ // kodak_ultramax_400 kodak_2383, 7 5
4.65438,
0.173299,
0.6356,
0.923385,
},
{ // kodak_ultramax_400 kodak_2393 7 6
3.98538,
0.546895,
0.430412,
0.713918,
},
},
{
{ // kodak_vision3_50d kodak_endura_premier, 8 0
-3.24577,
0.436051,
0.17022,
0.248745,
},
{ // kodak_vision3_50d kodak_ektacolor_edge, 8 1
-2.53963,
0.512466,
0.380419,
0.589444,
},
{ // kodak_vision3_50d kodak_supra_endura, 8 2
-2.91694,
0.349159,
0.0771834,
0.158198,
},
{ // kodak_vision3_50d kodak_portra_endura, 8 3
-2.42604,
0.516975,
0.262071,
0.333144,
},
{ // kodak_vision3_50d fujifilm_crystal_archive_typeii, 8 4
-3.84107,
0.5388,
0.0748281,
0.664011,
},
{ // kodak_vision3_50d kodak_2383, 8 5
1.81179,
0.425439,
0.395883,
0.904635,
},
{ // kodak_vision3_50d kodak_2393 8 6
1.57185,
0.748926,
0.319669,
0.735735,
},
},
{
{ // kodak_vision3_250d kodak_endura_premier, 9 0
-1.08895,
0.602641,
0.448664,
0.542377,
},
{ // kodak_vision3_250d kodak_ektacolor_edge, 9 1
-0.655185,
0.608801,
0.524149,
0.705096,
},
{ // kodak_vision3_250d kodak_supra_endura, 9 2
0.180186,
0.747354,
0.516843,
0.717012,
},
{ // kodak_vision3_250d kodak_portra_endura, 9 3
-1.20434,
0.397411,
0.234266,
0.245557,
},
{ // kodak_vision3_250d fujifilm_crystal_archive_typeii, 9 4
-1.94857,
0.633833,
0.30237,
0.753488,
},
{ // kodak_vision3_250d kodak_2383, 9 5
2.52493,
0.000374193,
0.125611,
0.857692,
},
{ // kodak_vision3_250d kodak_2393 9 6
2.49632,
0.617275,
0.0940436,
0.648572,
},
},
{
{ // kodak_vision3_200t kodak_endura_premier, 10 0
-0.448218,
0.791757,
0.574333,
0.538477,
},
{ // kodak_vision3_200t kodak_ektacolor_edge, 10 1
-1.09286,
0.598795,
0.295885,
0.411813,
},
{ // kodak_vision3_200t kodak_supra_endura, 10 2
0.0787058,
0.787627,
0.455734,
0.57174,
},
{ // kodak_vision3_200t kodak_portra_endura, 10 3
0.0753313,
0.786669,
0.488121,
0.535158,
},
{ // kodak_vision3_200t fujifilm_crystal_archive_typeii, 10 4
-1.59621,
0.768538,
0.351641,
0.711709,
},
{ // kodak_vision3_200t kodak_2383, 10 5
3.1098,
0.458195,
0.257531,
0.845393,
},
{ // kodak_vision3_200t kodak_2393 10 6
2.73068,
0.743241,
0.104181,
0.529049,
},
},
{
{ // kodak_vision3_500t kodak_endura_premier, 11 0
-0.935345,
0.644376,
0.214436,
0.0392308,
},
{ // kodak_vision3_500t kodak_ektacolor_edge, 11 1
-0.995799,
0.528391,
0.0713277,
0.156523,
},
{ // kodak_vision3_500t kodak_supra_endura, 11 2
-0.165561,
0.673711,
0.393168,
0.141429,
},
{ // kodak_vision3_500t kodak_portra_endura, 11 3
-0.132108,
0.679595,
0.445286,
0.088425,
},
{ // kodak_vision3_500t fujifilm_crystal_archive_typeii, 11 4
-1.67277,
0.694103,
0.00102429,
0.598298,
},
{ // kodak_vision3_500t kodak_2383, 11 5
3.66507,
0.505126,
0.235806,
0.825062,
},
{ // kodak_vision3_500t kodak_2393 11 6
3.16356,
0.747465,
0.0336598,
0.416675,
},
},
{
{ // fujifilm_pro_400h kodak_endura_premier, 12 0
-2.03846,
0.617314,
0.586581,
0.5995,
},
{ // fujifilm_pro_400h kodak_ektacolor_edge, 12 1
-2.01119,
0.451185,
0.549099,
0.668521,
},
{ // fujifilm_pro_400h kodak_supra_endura, 12 2
-2.38328,
0.356865,
0.266717,
0.250812,
},
{ // fujifilm_pro_400h kodak_portra_endura, 12 3
-1.95724,
0.504746,
0.405952,
0.382683,
},
{ // fujifilm_pro_400h fujifilm_crystal_archive_typeii, 12 4
-3.95807,
0.105984,
0.0283507,
0.594351,
},
{ // fujifilm_pro_400h kodak_2383, 12 5
2.14861,
0.355929,
0.508559,
0.913192,
},
{ // fujifilm_pro_400h kodak_2393 12 6
1.25112,
0.586369,
0.160827,
0.636069,
},
},
{
{ // fujifilm_xtra_400 kodak_endura_premier, 13 0
-3.48657,
0.161033,
0.0310671,
0.134408,
},
{ // fujifilm_xtra_400 kodak_ektacolor_edge, 13 1
-3.09342,
0.0903029,
0.123927,
0.426888,
},
{ // fujifilm_xtra_400 kodak_supra_endura, 13 2
-2.2705,
0.424577,
0.346993,
0.380515,
},
{ // fujifilm_xtra_400 kodak_portra_endura, 13 3
-2.22612,
0.438651,
0.401471,
0.347184,
},
{ // fujifilm_xtra_400 fujifilm_crystal_archive_typeii, 13 4
-3.53389,
0.4793,
0.206561,
0.72179,
},
{ // fujifilm_xtra_400 kodak_2383, 13 5
2.08796,
0.385313,
0.471755,
0.918067,
},
{ // fujifilm_xtra_400 kodak_2393 13 6
1.24564,
0.608916,
0.138239,
0.666611,
},
},
{
{ // fujifilm_c200 kodak_endura_premier, 14 0
-2.15563,
0.362618,
0.558571,
0.684081,
},
{ // fujifilm_c200 kodak_ektacolor_edge, 14 1
-2.27344,
0.00498892,
0.482091,
0.716478,
},
{ // fujifilm_c200 kodak_supra_endura, 14 2
-1.6569,
0.367629,
0.42131,
0.685734,
},
{ // fujifilm_c200 kodak_portra_endura, 14 3
-2.33586,
0.0307158,
0.289251,
0.477207,
},
{ // fujifilm_c200 fujifilm_crystal_archive_typeii, 14 4
-3.42728,
0.000526626,
0.313279,
0.773467,
},
{ // fujifilm_c200 kodak_2383, 14 5
3.07268,
0.455133,
0.731419,
0.96489,
},
{ // fujifilm_c200 kodak_2393 14 6
1.5788,
0.472686,
0.323785,
0.783129,
},
},
};
