#pragma once
// the rest of this header is autogenerated by the following script:
#if 0
#!/bin/bash

films=(
kodak_ektar_100
kodak_portra_160
kodak_portra_400
kodak_portra_800
kodak_portra_800_push1
kodak_portra_800_push2
kodak_gold_200
kodak_ultramax_400
kodak_vision3_50d
kodak_vision3_250d
kodak_vision3_200t
kodak_vision3_500t
fujifilm_pro_400h
fujifilm_xtra_400
fujifilm_c200
)

papers=(
kodak_endura_premier
kodak_ektacolor_edge
kodak_supra_endura
kodak_portra_endura
fujifilm_crystal_archive_typeii
kodak_2383
kodak_2393
)

n_films=${#films[@]}
n_papers=${#papers[@]}
# ${films[0]}

cat << EOF > neutral.cfg
frames:1
fps:0
module:const:main:23.3783:290.7
module:filmsim:01:255.558:326.7
module:display:main:719.252:340.033
# module:display:hist:719.252:540.033
module:pick:01:510.405:124.7
module:i-lut:filmsim:21.3333:441
module:i-lut:spectem:20:580.333
connect:const:main:output:filmsim:01:input
connect:i-lut:filmsim:output:filmsim:01:filmsim
connect:i-lut:spectem:output:filmsim:01:spectra
connect:filmsim:01:output:display:main:input
connect:filmsim:01:output:pick:01:input
# connect:pick:01:picked:dsp_:hist:input
param:const:main:nspots:1
param:const:main:mode:0
param:const:main:wd:4
param:const:main:ht:4
param:pick:01:nspots:1
param:pick:01:spots:0:1:0:1
param:pick:01:show:2
param:pick:01:grab:1
param:pick:01:freeze:0
param:i-lut:filmsim:filename:data/filmsim.lut
param:i-lut:spectem:filename:data/spectra-em.lut
param:const:main:colour:0.184:0.184:0.184:1
param:pick:01:ref:0.192:0.188:0.208
param:filmsim:01:filter c:0.2
param:filmsim:01:filter m:0.5
param:filmsim:01:filter y:0.5
param:filmsim:01:ev paper:0
param:filmsim:01:ev film:0
param:filmsim:01:couplers:0
param:filmsim:01:halation:0
param:filmsim:01:grain:0
EOF

# this is for 0.5 linear, i.e. more highlights
# param:const:main:colour:0.5:0.5:0.5:1
# param:pick:01:ref:.4821:0.5:.41255
# this is the 50% after gamma:
# param:const:main:colour:0.184:0.184:0.184:1
# D50
# param:pick:01:ref:0.192096:0.182712:0.159528
# D65
# param:pick:01:ref:0.184:0.184:0.184

echo "// ev paper, filter c, filter m, filter y" > results.txt
echo "const float wb[$n_films][$n_papers][4] = {" >> results.txt
f=0
for film in ${films[@]}
do
  p=0
  echo "{" >> results.txt
  for paper in ${papers[@]}
  do
    echo $film $paper $f $p

#--nelder-mead
#--adam 0.00001 0.99 0.999 1e-3
    vkdt fit -d none -g neutral.cfg \
      --param "filmsim:01:filter c" \
      --param "filmsim:01:filter m" \
      --param "filmsim:01:filter y" \
      --param "filmsim:01:ev paper" \
      --target "pick:01:de76" \
      --bogosearch \
      --config "param:filmsim:01:film:$f" "param:filmsim:01:paper:$p" > neutral-warmup.cfg
    vkdt fit -d none -g neutral-warmup.cfg \
      --param "filmsim:01:filter c" \
      --param "filmsim:01:filter m" \
      --param "filmsim:01:filter y" \
      --param "filmsim:01:ev paper" \
      --target "pick:01:de76" \
      --nelder-mead \
      --config "param:filmsim:01:film:$f" "param:filmsim:01:paper:$p" > neutral-opt.cfg
    echo "{ //" $film $paper $f $p >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:ev paper' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter c' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter m' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter y' | cut -d: -f5), >> results.txt
    echo "}," >> results.txt
    p=$((p+1))
  done
  echo "}," >> results.txt
  f=$((f+1))
done
echo "};" >> results.txt
rm neutral-opt.cfg neutral.cfg neutral-warmup.cfg
#endif

// ev paper, filter c, filter m, filter y
const float wb[15][7][4] = {
{
{ // kodak_ektar_100 kodak_endura_premier 0 0
-0.0191399,
0.401701,
0.794325,
0.750232,
},
{ // kodak_ektar_100 kodak_ektacolor_edge 0 1
0.0999798,
0.0470087,
0.793344,
0.808113,
},
{ // kodak_ektar_100 kodak_supra_endura 0 2
-0.702448,
0.06654,
0.445435,
0.50033,
},
{ // kodak_ektar_100 kodak_portra_endura 0 3
-0.701958,
0.0619008,
0.479941,
0.458978,
},
{ // kodak_ektar_100 fujifilm_crystal_archive_typeii 0 4
0.014854,
0.48483,
0.86109,
0.922634,
},
{ // kodak_ektar_100 kodak_2383 0 5
4.62361,
0.211737,
0.831274,
0.959673,
},
{ // kodak_ektar_100 kodak_2393 0 6
2.66982,
0,
0.443024,
0.657213,
},
},
{
{ // kodak_portra_160 kodak_endura_premier 1 0
-1.38798,
0.250102,
0.53138,
0.599124,
},
{ // kodak_portra_160 kodak_ektacolor_edge 1 1
-0.0803378,
0.42793,
0.769478,
0.855581,
},
{ // kodak_portra_160 kodak_supra_endura 1 2
-1.31113,
0.247683,
0.132179,
0.584304,
},
{ // kodak_portra_160 kodak_portra_endura 1 3
-0.841331,
0.427726,
0.323258,
0.665387,
},
{ // kodak_portra_160 fujifilm_crystal_archive_typeii 1 4
-0.217193,
0.679193,
0.843954,
0.935937,
},
{ // kodak_portra_160 kodak_2383 1 5
3.40456,
0.110474,
0.649588,
0.944197,
},
{ // kodak_portra_160 kodak_2393 1 6
2.33046,
0.418487,
0.288323,
0.736633,
},
},
{
{ // kodak_portra_400 kodak_endura_premier 2 0
-0.259959,
0.300702,
0.427642,
0.465562,
},
{ // kodak_portra_400 kodak_ektacolor_edge 2 1
0.438944,
0.269311,
0.581047,
0.713161,
},
{ // kodak_portra_400 kodak_supra_endura 2 2
1.34254,
0.692825,
0.455049,
0.81421,
},
{ // kodak_portra_400 kodak_portra_endura 2 3
1.96938,
0.790065,
0.625611,
0.866707,
},
{ // kodak_portra_400 fujifilm_crystal_archive_typeii 2 4
-1.01792,
0.0125413,
0.355961,
0.740994,
},
{ // kodak_portra_400 kodak_2383 2 5
4.62393,
0.198339,
0.60506,
0.926264,
},
{ // kodak_portra_400 kodak_2393 2 6
3.43164,
0.408429,
0.148879,
0.624875,
},
},
{
{ // kodak_portra_800 kodak_endura_premier 3 0
0.459111,
0.286564,
0.566086,
0.689551,
},
{ // kodak_portra_800 kodak_ektacolor_edge 3 1
1.77101,
0.465771,
0.787268,
0.887685,
},
{ // kodak_portra_800 kodak_supra_endura 3 2
0.432442,
0.217126,
0.308528,
0.558845,
},
{ // kodak_portra_800 kodak_portra_endura 3 3
0.417507,
0.20259,
0.349274,
0.517176,
},
{ // kodak_portra_800 fujifilm_crystal_archive_typeii 3 4
0.451934,
0.33578,
0.698208,
0.902574,
},
{ // kodak_portra_800 kodak_2383 3 5
5.01289,
-0.000672784,
0.656626,
0.946105,
},
{ // kodak_portra_800 kodak_2393 3 6
3.74334,
0.26149,
0.199846,
0.70622,
},
},
{
{ // kodak_portra_800_push1 kodak_endura_premier 4 0
1.00109,
0.113587,
0.50744,
0.668161,
},
{ // kodak_portra_800_push1 kodak_ektacolor_edge 4 1
2.12312,
0.255903,
0.723881,
0.863433,
},
{ // kodak_portra_800_push1 kodak_supra_endura 4 2
1.09062,
0.104654,
0.276536,
0.570324,
},
{ // kodak_portra_800_push1 kodak_portra_endura 4 3
1.09462,
0.0955065,
0.323259,
0.535444,
},
{ // kodak_portra_800_push1 fujifilm_crystal_archive_typeii 4 4
0.801318,
0.0452489,
0.616344,
0.885261,
},
{ // kodak_portra_800_push1 kodak_2383 4 5
5.10783,
0,
0.571178,
0.946482,
},
{ // kodak_portra_800_push1 kodak_2393 4 6
4.41901,
0.125807,
0.190746,
0.708594,
},
},
{
{ // kodak_portra_800_push2 kodak_endura_premier 5 0
1.20658,
0.0743739,
0.414069,
0.647245,
},
{ // kodak_portra_800_push2 kodak_ektacolor_edge 5 1
1.89062,
8.79438e-05,
0.5685,
0.808233,
},
{ // kodak_portra_800_push2 kodak_supra_endura 5 2
1.27346,
0.0591683,
0.172577,
0.542069,
},
{ // kodak_portra_800_push2 kodak_portra_endura 5 3
1.28102,
0.0485249,
0.228334,
0.505704,
},
{ // kodak_portra_800_push2 fujifilm_crystal_archive_typeii 5 4
1.05313,
0.00950839,
0.555638,
0.882609,
},
{ // kodak_portra_800_push2 kodak_2383 5 5
4.99874,
1.08667e-05,
0.487447,
0.939402,
},
{ // kodak_portra_800_push2 kodak_2393 5 6
4.71193,
0.123976,
0.0991247,
0.70615,
},
},
{
{ // kodak_gold_200 kodak_endura_premier 6 0
-1.05065,
0.330737,
0.390953,
0.532014,
},
{ // kodak_gold_200 kodak_ektacolor_edge 6 1
-0.842988,
0.0587677,
0.406265,
0.65838,
},
{ // kodak_gold_200 kodak_supra_endura 6 2
-0.603101,
0.377663,
0.247027,
0.567696,
},
{ // kodak_gold_200 kodak_portra_endura 6 3
-1.35734,
0.0135071,
0.0974326,
0.245039,
},
{ // kodak_gold_200 fujifilm_crystal_archive_typeii 6 4
-0.562908,
0.578106,
0.676502,
0.891644,
},
{ // kodak_gold_200 kodak_2383 6 5
4.06937,
0.360039,
0.615093,
0.942667,
},
{ // kodak_gold_200 kodak_2393 6 6
3.19946,
0.605269,
0.331758,
0.758343,
},
},
{
{ // kodak_ultramax_400 kodak_endura_premier 7 0
-0.273261,
0.267781,
0.462816,
0.493457,
},
{ // kodak_ultramax_400 kodak_ektacolor_edge 7 1
0.423743,
0.236506,
0.60513,
0.726551,
},
{ // kodak_ultramax_400 kodak_supra_endura 7 2
-0.44891,
0.0195367,
0.223706,
0.230397,
},
{ // kodak_ultramax_400 kodak_portra_endura 7 3
-0.448506,
0.0112772,
0.281033,
0.164589,
},
{ // kodak_ultramax_400 fujifilm_crystal_archive_typeii 7 4
-0.979683,
0.000282921,
0.4088,
0.77219,
},
{ // kodak_ultramax_400 kodak_2383 7 5
4.66431,
0.192273,
0.635721,
0.929962,
},
{ // kodak_ultramax_400 kodak_2393 7 6
3.40696,
0.376004,
0.196312,
0.62199,
},
},
{
{ // kodak_vision3_50d kodak_endura_premier 8 0
-1.59949,
0.800387,
0.687352,
0.745954,
},
{ // kodak_vision3_50d kodak_ektacolor_edge 8 1
-2.68449,
0.477319,
0.319462,
0.57414,
},
{ // kodak_vision3_50d kodak_supra_endura 8 2
-1.4378,
0.747519,
0.443391,
0.697279,
},
{ // kodak_vision3_50d kodak_portra_endura 8 3
-1.44012,
0.747016,
0.472025,
0.671817,
},
{ // kodak_vision3_50d fujifilm_crystal_archive_typeii 8 4
-3.79127,
0.560839,
0.0986178,
0.693502,
},
{ // kodak_vision3_50d kodak_2383 8 5
2.0246,
0.506662,
0.467703,
0.923215,
},
{ // kodak_vision3_50d kodak_2393 8 6
2.07244,
0.820835,
0.500099,
0.823178,
},
},
{
{ // kodak_vision3_250d kodak_endura_premier 9 0
-0.117473,
0.788381,
0.694541,
0.765409,
},
{ // kodak_vision3_250d kodak_ektacolor_edge 9 1
-1.39669,
0.395459,
0.251405,
0.557016,
},
{ // kodak_vision3_250d kodak_supra_endura 9 2
-1.03712,
0.473191,
0.178616,
0.416785,
},
{ // kodak_vision3_250d kodak_portra_endura 9 3
-1.22596,
0.406492,
0.186237,
0.285546,
},
{ // kodak_vision3_250d fujifilm_crystal_archive_typeii 9 4
-2.30672,
0.551015,
0.12432,
0.721168,
},
{ // kodak_vision3_250d kodak_2383 9 5
4.59478,
0.739542,
0.749067,
0.964492,
},
{ // kodak_vision3_250d kodak_2393 9 6
3.34699,
0.778053,
0.45716,
0.810385,
},
},
{
{ // kodak_vision3_200t kodak_endura_premier 10 0
-1.75618,
0.550357,
0.093543,
0.00287525,
},
{ // kodak_vision3_200t kodak_ektacolor_edge 10 1
-1.66836,
0.448099,
0.0141738,
0.209536,
},
{ // kodak_vision3_200t kodak_supra_endura 10 2
-1.32273,
0.506666,
0.0930681,
0.000799933,
},
{ // kodak_vision3_200t kodak_portra_endura 10 3
-1.19537,
0.542168,
0.189341,
0,
},
{ // kodak_vision3_200t fujifilm_crystal_archive_typeii 10 4
-1.4778,
0.78918,
0.396713,
0.747247,
},
{ // kodak_vision3_200t kodak_2383 10 5
3.9409,
0.685334,
0.5525,
0.915704,
},
{ // kodak_vision3_200t kodak_2393 10 6
3.54383,
0.847319,
0.449166,
0.740583,
},
},
{
{ // kodak_vision3_500t kodak_endura_premier 11 0
-0.852873,
0.666315,
0.238738,
0.128456,
},
{ // kodak_vision3_500t kodak_ektacolor_edge 11 1
1.7935,
0.919754,
0.830392,
0.866011,
},
{ // kodak_vision3_500t kodak_supra_endura 11 2
0.0250137,
0.717012,
0.393511,
0.292499,
},
{ // kodak_vision3_500t kodak_portra_endura 11 3
0.0423886,
0.71988,
0.440517,
0.241409,
},
{ // kodak_vision3_500t fujifilm_crystal_archive_typeii 11 4
-1.10482,
0.788351,
0.296922,
0.718824,
},
{ // kodak_vision3_500t kodak_2383 11 5
3.58158,
0.48756,
0.192277,
0.830868,
},
{ // kodak_vision3_500t kodak_2393 11 6
3.42451,
0.788222,
0.157327,
0.543326,
},
},
{
{ // fujifilm_pro_400h kodak_endura_premier 12 0
-3.20854,
0.23286,
0.181422,
0.210477,
},
{ // fujifilm_pro_400h kodak_ektacolor_edge 12 1
-2.3683,
0.327707,
0.43741,
0.607028,
},
{ // fujifilm_pro_400h kodak_supra_endura 12 2
-2.70932,
0.234309,
0.147556,
0.138207,
},
{ // fujifilm_pro_400h kodak_portra_endura 12 3
-2.70802,
0.232979,
0.211773,
0.0643213,
},
{ // fujifilm_pro_400h fujifilm_crystal_archive_typeii 12 4
-3.91412,
0.145272,
0.0473473,
0.628671,
},
{ // fujifilm_pro_400h kodak_2383 12 5
2.09207,
0.343407,
0.489337,
0.917324,
},
{ // fujifilm_pro_400h kodak_2393 12 6
2.12321,
0.764469,
0.505301,
0.806745,
},
},
{
{ // fujifilm_xtra_400 kodak_endura_premier 13 0
-2.917,
0.409866,
0.281012,
0.41225,
},
{ // fujifilm_xtra_400 kodak_ektacolor_edge 13 1
-2.41194,
0.4082,
0.402489,
0.639297,
},
{ // fujifilm_xtra_400 kodak_supra_endura 13 2
-2.87666,
0.183151,
0.172788,
0.146976,
},
{ // fujifilm_xtra_400 kodak_portra_endura 13 3
-2.7915,
0.223171,
0.252567,
0.122256,
},
{ // fujifilm_xtra_400 fujifilm_crystal_archive_typeii 13 4
-3.90596,
0.357753,
5.62648e-05,
0.685116,
},
{ // fujifilm_xtra_400 kodak_2383 13 5
2.09769,
0.399343,
0.472717,
0.925164,
},
{ // fujifilm_xtra_400 kodak_2393 13 6
2.12102,
0.777998,
0.492945,
0.823151,
},
},
{
{ // fujifilm_c200 kodak_endura_premier 14 0
-2.39502,
0.272215,
0.487953,
0.649749,
},
{ // fujifilm_c200 kodak_ektacolor_edge 14 1
-2.26658,
0.0283451,
0.480607,
0.731872,
},
{ // fujifilm_c200 kodak_supra_endura 14 2
-2.34886,
0.0534167,
0.203228,
0.545403,
},
{ // fujifilm_c200 kodak_portra_endura 14 3
-2.40728,
0.015186,
0.236878,
0.488135,
},
{ // fujifilm_c200 fujifilm_crystal_archive_typeii 14 4
-3.42853,
0.0190766,
0.309926,
0.78775,
},
{ // fujifilm_c200 kodak_2383 14 5
3.06145,
0.460534,
0.728947,
0.967505,
},
{ // fujifilm_c200 kodak_2393 14 6
1.04037,
0.284521,
0.0614414,
0.722287,
},
},
};
